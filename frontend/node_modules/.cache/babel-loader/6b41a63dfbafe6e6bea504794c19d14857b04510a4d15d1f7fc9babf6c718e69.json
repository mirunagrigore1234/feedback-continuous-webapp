{"ast":null,"code":"var _jsxFileName = \"D:\\\\Anul III\\\\TW\\\\feedback-continuous-webapp\\\\frontend\\\\src\\\\components\\\\activityInfo.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport feedbackService from \"../services/feedbackService\";\nimport activityService from \"../services/activityService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction timeAgo(ts) {\n  const d = new Date(ts);\n  const sec = Math.max(1, Math.floor((Date.now() - d.getTime()) / 1000));\n  if (sec < 60) return `${sec}s ago`;\n  const min = Math.floor(sec / 60);\n  if (min < 60) return `${min}m ago`;\n  const h = Math.floor(min / 60);\n  return `${h}h ago`;\n}\nconst EMOJI = {\n  happy: \"ðŸ˜„\",\n  surprised: \"ðŸ˜®\",\n  confused: \"ðŸ¤”\",\n  sad: \"ðŸ˜£\"\n};\nfunction getTs(f) {\n  return new Date(f.Timestamp || f.timestamp || f.createdAt || f.created_at).getTime();\n}\nfunction getKey(f) {\n  const id = f.Id || f.id;\n  if (id != null) return `id:${id}`;\n  return `t:${getTs(f)}|e:${(f.Emotion || f.emotion || \"\").toLowerCase()}`;\n}\nexport default function ActivityInfo() {\n  _s();\n  var _ref, _activity$Title, _ref2, _activity$AccessCode;\n  const nav = useNavigate();\n  const {\n    id\n  } = useParams();\n  const cacheKey = `classpulse_feedback_activity_${id}`;\n  const [activity, setActivity] = useState(null);\n  const [feedback, setFeedback] = useState(() => {\n    try {\n      const raw = localStorage.getItem(cacheKey);\n      return raw ? JSON.parse(raw) : [];\n    } catch {\n      return [];\n    }\n  });\n  const [error, setError] = useState(\"\");\n  useEffect(() => {\n    let stop = false;\n    async function loadActivity() {\n      try {\n        const a = await activityService.getActivityById(id);\n        if (!stop) setActivity(a);\n      } catch {}\n    }\n    function saveCache(list) {\n      try {\n        localStorage.setItem(cacheKey, JSON.stringify(list));\n      } catch {}\n    }\n    function mergeDedup(prev, next) {\n      const map = new Map();\n      for (const f of prev) map.set(getKey(f), f);\n      for (const f of next) map.set(getKey(f), f);\n      return Array.from(map.values()).sort((a, b) => getTs(b) - getTs(a));\n    }\n    async function pollFeedback() {\n      try {\n        const list = await feedbackService.getFeedbacksByActivity(id);\n        if (stop) return;\n        if (Array.isArray(list) && list.length > 0) {\n          setFeedback(prev => {\n            const merged = mergeDedup(prev, list);\n            saveCache(merged);\n            return merged;\n          });\n          setError(\"\");\n        } else {\n          setError(\"\");\n        }\n      } catch {\n        if (!stop) setError(\"Cannot load feedback (showing last known results).\");\n      }\n    }\n    loadActivity();\n    pollFeedback();\n    const t = setInterval(pollFeedback, 2000);\n    return () => {\n      stop = true;\n      clearInterval(t);\n    };\n  }, [id]);\n  const stats = useMemo(() => {\n    const now = Date.now();\n    const relevant = feedback.filter(f => now - getTs(f) <= 15 * 60 * 1000);\n    const total = relevant.length || 1;\n    const counts = {\n      happy: 0,\n      confused: 0,\n      surprised: 0,\n      sad: 0\n    };\n    for (const f of relevant) {\n      const e = (f.Emotion || f.emotion || \"\").toLowerCase();\n      if (counts[e] !== undefined) counts[e]++;\n    }\n    const pct = x => Math.round(x * 100 / total);\n    return {\n      total: relevant.length,\n      happy: pct(counts.happy),\n      confused: pct(counts.confused),\n      surprised: pct(counts.surprised),\n      sad: pct(counts.sad)\n    };\n  }, [feedback]);\n  const feed = useMemo(() => {\n    return [...feedback].sort((a, b) => getTs(b) - getTs(a)).slice(0, 8);\n  }, [feedback]);\n  const series = useMemo(() => {\n    const buckets = Array.from({\n      length: 15\n    }, () => ({\n      happy: 0,\n      confused: 0,\n      surprised: 0,\n      sad: 0,\n      total: 0\n    }));\n    const now = Date.now();\n    for (const f of feedback) {\n      const ts = getTs(f);\n      const diffMin = Math.floor((now - ts) / 60000);\n      if (diffMin < 0 || diffMin > 14) continue;\n      const idx = 14 - diffMin;\n      const e = (f.Emotion || f.emotion || \"\").toLowerCase();\n      if (buckets[idx] && buckets[idx][e] !== undefined) buckets[idx][e]++;\n      buckets[idx].total++;\n    }\n    return buckets.map(b => {\n      const t = b.total || 1;\n      return {\n        happy: b.happy / t,\n        surprised: b.surprised / t,\n        confused: b.confused / t,\n        sad: b.sad / t\n      };\n    });\n  }, [feedback]);\n  const title = (_ref = (_activity$Title = activity === null || activity === void 0 ? void 0 : activity.Title) !== null && _activity$Title !== void 0 ? _activity$Title : activity === null || activity === void 0 ? void 0 : activity.title) !== null && _ref !== void 0 ? _ref : \"Activity\";\n  const code = (_ref2 = (_activity$AccessCode = activity === null || activity === void 0 ? void 0 : activity.AccessCode) !== null && _activity$AccessCode !== void 0 ? _activity$AccessCode : activity === null || activity === void 0 ? void 0 : activity.access_code) !== null && _ref2 !== void 0 ? _ref2 : \"\";\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"aWrap\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"aSide\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"aBrand\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aLogo\",\n          children: \"\\uD83C\\uDF93\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"ClassPulse\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"aNewBtn\",\n        onClick: () => nav(\"/professor/dashboard\"),\n        children: \"\\uFF0B Create New Session\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"aMain\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"aHeader\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"aTitle\",\n          children: title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aMeta\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\uD83D\\uDD11 Code: \", /*#__PURE__*/_jsxDEV(\"b\", {\n              children: code || \"â€”\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 24\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"errorBox\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"aStatGrid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aStatCard blue\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatTop\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aStatLabel\",\n              children: \"UNDERSTANDING\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aMiniEmoji\",\n              children: \"\\uD83D\\uDE04\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatValue\",\n            children: [stats.happy, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aStatCard purple\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatTop\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aStatLabel\",\n              children: \"CONFUSED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aMiniEmoji\",\n              children: \"\\uD83E\\uDD14\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatValue\",\n            children: [stats.confused, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aStatCard yellow\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatTop\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aStatLabel\",\n              children: \"SURPRISED\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aMiniEmoji\",\n              children: \"\\uD83D\\uDE2E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatValue\",\n            children: [stats.surprised, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"aStatCard red\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatTop\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aStatLabel\",\n              children: \"LOST\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aMiniEmoji\",\n              children: \"\\uD83D\\uDE23\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aStatValue\",\n            children: [stats.sad, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"aBottomGrid\",\n        children: [/*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"aCard\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aCardTitle\",\n            children: \"Live Sentiment Timeline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mutedSmall\",\n            children: \"Real-time student reactions over the last 15 minutes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aLegend\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"legDot blueDot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 21\n              }, this), \" Happy\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"legDot yellowDot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 21\n              }, this), \" Surprised\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"legDot purpleDot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 21\n              }, this), \" Confused\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"legDot redDot\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 218,\n                columnNumber: 21\n              }, this), \" Lost\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aChart\",\n            children: series.map((p, idx) => {\n              const h1 = Math.round(p.happy * 100);\n              const h2 = Math.round(p.surprised * 100);\n              const h3 = Math.round(p.confused * 100);\n              const h4 = Math.round(p.sad * 100);\n              const max = Math.max(h1, h2, h3, h4);\n              let cls = \"blueBar\";\n              if (max === h2) cls = \"yellowBar\";else if (max === h3) cls = \"purpleBar\";else if (max === h4) cls = \"redBar\";\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"aCol\",\n                title: `bucket ${idx + 1}`,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `aBar ${cls}`,\n                  style: {\n                    height: `${max}%`\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 21\n                }, this)\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aChartAxis\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"14:45\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"14:50\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"14:55\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"15:00 (NOW)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"aCard\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aFeedTop\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"aCardTitle\",\n                children: \"Live Feed\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 249,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mutedSmall\",\n                children: \"Latest reactions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 250,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"aGreenDot\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"aFeedList\",\n            children: feed.map((f, i) => {\n              var _getKey;\n              const emo = (f.Emotion || f.emotion || \"happy\").toLowerCase();\n              const ts = f.Timestamp || f.timestamp || f.createdAt;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"aFeedRow\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"aFeedEmoji\",\n                  children: EMOJI[emo] || \"ðŸ™‚\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 260,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"aFeedText\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"aFeedTitle\",\n                    children: \"Anonymous Student\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 262,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"aFeedSub\",\n                    children: [\"Reacted \", /*#__PURE__*/_jsxDEV(\"b\", {\n                      children: [\"\\\"\", emo, \"\\\"\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 263,\n                      columnNumber: 57\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 263,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 261,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"aFeedTime\",\n                  children: timeAgo(ts)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 21\n                }, this)]\n              }, (_getKey = getKey(f)) !== null && _getKey !== void 0 ? _getKey : i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 5\n  }, this);\n}\n_s(ActivityInfo, \"Zkuo86rfNqb0m1QKFkJMNON6Dpw=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = ActivityInfo;\nvar _c;\n$RefreshReg$(_c, \"ActivityInfo\");","map":{"version":3,"names":["useEffect","useMemo","useState","useNavigate","useParams","feedbackService","activityService","jsxDEV","_jsxDEV","timeAgo","ts","d","Date","sec","Math","max","floor","now","getTime","min","h","EMOJI","happy","surprised","confused","sad","getTs","f","Timestamp","timestamp","createdAt","created_at","getKey","id","Id","Emotion","emotion","toLowerCase","ActivityInfo","_s","_ref","_activity$Title","_ref2","_activity$AccessCode","nav","cacheKey","activity","setActivity","feedback","setFeedback","raw","localStorage","getItem","JSON","parse","error","setError","stop","loadActivity","a","getActivityById","saveCache","list","setItem","stringify","mergeDedup","prev","next","map","Map","set","Array","from","values","sort","b","pollFeedback","getFeedbacksByActivity","isArray","length","merged","t","setInterval","clearInterval","stats","relevant","filter","total","counts","e","undefined","pct","x","round","feed","slice","series","buckets","diffMin","idx","title","Title","code","AccessCode","access_code","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","p","h1","h2","h3","h4","cls","style","height","i","_getKey","emo","_c","$RefreshReg$"],"sources":["D:/Anul III/TW/feedback-continuous-webapp/frontend/src/components/activityInfo.jsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport feedbackService from \"../services/feedbackService\";\r\nimport activityService from \"../services/activityService\";\r\n\r\nfunction timeAgo(ts) {\r\n  const d = new Date(ts);\r\n  const sec = Math.max(1, Math.floor((Date.now() - d.getTime()) / 1000));\r\n  if (sec < 60) return `${sec}s ago`;\r\n  const min = Math.floor(sec / 60);\r\n  if (min < 60) return `${min}m ago`;\r\n  const h = Math.floor(min / 60);\r\n  return `${h}h ago`;\r\n}\r\n\r\nconst EMOJI = {\r\n  happy: \"ðŸ˜„\",\r\n  surprised: \"ðŸ˜®\",\r\n  confused: \"ðŸ¤”\",\r\n  sad: \"ðŸ˜£\"\r\n};\r\n\r\nfunction getTs(f) {\r\n  return new Date(f.Timestamp || f.timestamp || f.createdAt || f.created_at).getTime();\r\n}\r\n\r\nfunction getKey(f) {\r\n  const id = f.Id || f.id;\r\n  if (id != null) return `id:${id}`;\r\n  return `t:${getTs(f)}|e:${(f.Emotion || f.emotion || \"\").toLowerCase()}`;\r\n}\r\n\r\nexport default function ActivityInfo() {\r\n  const nav = useNavigate();\r\n  const { id } = useParams();\r\n  const cacheKey = `classpulse_feedback_activity_${id}`;\r\n\r\n  const [activity, setActivity] = useState(null);\r\n  const [feedback, setFeedback] = useState(() => {\r\n    try {\r\n      const raw = localStorage.getItem(cacheKey);\r\n      return raw ? JSON.parse(raw) : [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  });\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    let stop = false;\r\n\r\n    async function loadActivity() {\r\n      try {\r\n        const a = await activityService.getActivityById(id);\r\n        if (!stop) setActivity(a);\r\n      } catch {}\r\n    }\r\n\r\n    function saveCache(list) {\r\n      try {\r\n        localStorage.setItem(cacheKey, JSON.stringify(list));\r\n      } catch {}\r\n    }\r\n\r\n    function mergeDedup(prev, next) {\r\n      const map = new Map();\r\n      for (const f of prev) map.set(getKey(f), f);\r\n      for (const f of next) map.set(getKey(f), f);\r\n      return Array.from(map.values()).sort((a, b) => getTs(b) - getTs(a));\r\n    }\r\n\r\n    async function pollFeedback() {\r\n      try {\r\n        const list = await feedbackService.getFeedbacksByActivity(id);\r\n        if (stop) return;\r\n        if (Array.isArray(list) && list.length > 0) {\r\n          setFeedback((prev) => {\r\n            const merged = mergeDedup(prev, list);\r\n            saveCache(merged);\r\n            return merged;\r\n          });\r\n          setError(\"\");\r\n        } else {\r\n          setError(\"\");\r\n        }\r\n      } catch {\r\n        if (!stop) setError(\"Cannot load feedback (showing last known results).\");\r\n      }\r\n    }\r\n\r\n    loadActivity();\r\n    pollFeedback();\r\n    const t = setInterval(pollFeedback, 2000);\r\n    return () => {\r\n      stop = true;\r\n      clearInterval(t);\r\n    };\r\n  }, [id]);\r\n\r\n  const stats = useMemo(() => {\r\n    const now = Date.now();\r\n    const relevant = feedback.filter((f) => now - getTs(f) <= 15 * 60 * 1000);\r\n    const total = relevant.length || 1;\r\n    const counts = { happy: 0, confused: 0, surprised: 0, sad: 0 };\r\n\r\n    for (const f of relevant) {\r\n      const e = (f.Emotion || f.emotion || \"\").toLowerCase();\r\n      if (counts[e] !== undefined) counts[e]++;\r\n    }\r\n\r\n    const pct = (x) => Math.round((x * 100) / total);\r\n    return {\r\n      total: relevant.length,\r\n      happy: pct(counts.happy),\r\n      confused: pct(counts.confused),\r\n      surprised: pct(counts.surprised),\r\n      sad: pct(counts.sad)\r\n    };\r\n  }, [feedback]);\r\n\r\n  const feed = useMemo(() => {\r\n    return [...feedback].sort((a, b) => getTs(b) - getTs(a)).slice(0, 8);\r\n  }, [feedback]);\r\n\r\n  const series = useMemo(() => {\r\n    const buckets = Array.from({ length: 15 }, () => ({\r\n      happy: 0, confused: 0, surprised: 0, sad: 0, total: 0\r\n    }));\r\n    const now = Date.now();\r\n\r\n    for (const f of feedback) {\r\n      const ts = getTs(f);\r\n      const diffMin = Math.floor((now - ts) / 60000);\r\n      if (diffMin < 0 || diffMin > 14) continue;\r\n      const idx = 14 - diffMin;\r\n      const e = (f.Emotion || f.emotion || \"\").toLowerCase();\r\n      if (buckets[idx] && buckets[idx][e] !== undefined) buckets[idx][e]++;\r\n      buckets[idx].total++;\r\n    }\r\n\r\n    return buckets.map((b) => {\r\n      const t = b.total || 1;\r\n      return {\r\n        happy: b.happy / t,\r\n        surprised: b.surprised / t,\r\n        confused: b.confused / t,\r\n        sad: b.sad / t\r\n      };\r\n    });\r\n  }, [feedback]);\r\n\r\n  const title = activity?.Title ?? activity?.title ?? \"Activity\";\r\n  const code = activity?.AccessCode ?? activity?.access_code ?? \"\";\r\n\r\n  return (\r\n    <div className=\"aWrap\">\r\n      <aside className=\"aSide\">\r\n        <div className=\"aBrand\">\r\n          <div className=\"aLogo\">ðŸŽ“</div>\r\n          <b>ClassPulse</b>\r\n        </div>\r\n        <button className=\"aNewBtn\" onClick={() => nav(\"/professor/dashboard\")}>\r\n          ï¼‹ Create New Session\r\n        </button>\r\n      </aside>\r\n\r\n      <main className=\"aMain\">\r\n        <div className=\"aHeader\">\r\n          <h1 className=\"aTitle\">{title}</h1>\r\n          <div className=\"aMeta\">\r\n            <span>\r\n              ðŸ”‘ Code: <b>{code || \"â€”\"}</b>\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {error && <div className=\"errorBox\">{error}</div>}\r\n\r\n        <div className=\"aStatGrid\">\r\n          <div className=\"aStatCard blue\">\r\n            <div className=\"aStatTop\">\r\n              <span className=\"aStatLabel\">UNDERSTANDING</span>\r\n              <span className=\"aMiniEmoji\">ðŸ˜„</span>\r\n            </div>\r\n            <div className=\"aStatValue\">{stats.happy}%</div>\r\n          </div>\r\n          <div className=\"aStatCard purple\">\r\n            <div className=\"aStatTop\">\r\n              <span className=\"aStatLabel\">CONFUSED</span>\r\n              <span className=\"aMiniEmoji\">ðŸ¤”</span>\r\n            </div>\r\n            <div className=\"aStatValue\">{stats.confused}%</div>\r\n          </div>\r\n          <div className=\"aStatCard yellow\">\r\n            <div className=\"aStatTop\">\r\n              <span className=\"aStatLabel\">SURPRISED</span>\r\n              <span className=\"aMiniEmoji\">ðŸ˜®</span>\r\n            </div>\r\n            <div className=\"aStatValue\">{stats.surprised}%</div>\r\n          </div>\r\n          <div className=\"aStatCard red\">\r\n            <div className=\"aStatTop\">\r\n              <span className=\"aStatLabel\">LOST</span>\r\n              <span className=\"aMiniEmoji\">ðŸ˜£</span>\r\n            </div>\r\n            <div className=\"aStatValue\">{stats.sad}%</div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"aBottomGrid\">\r\n          <section className=\"aCard\">\r\n            <div className=\"aCardTitle\">Live Sentiment Timeline</div>\r\n            <div className=\"mutedSmall\">Real-time student reactions over the last 15 minutes</div>\r\n            <div className=\"aLegend\">\r\n              <span><i className=\"legDot blueDot\" /> Happy</span>\r\n              <span><i className=\"legDot yellowDot\" /> Surprised</span>\r\n              <span><i className=\"legDot purpleDot\" /> Confused</span>\r\n              <span><i className=\"legDot redDot\" /> Lost</span>\r\n            </div>\r\n            <div className=\"aChart\">\r\n              {series.map((p, idx) => {\r\n                const h1 = Math.round(p.happy * 100);\r\n                const h2 = Math.round(p.surprised * 100);\r\n                const h3 = Math.round(p.confused * 100);\r\n                const h4 = Math.round(p.sad * 100);\r\n                const max = Math.max(h1, h2, h3, h4);\r\n                let cls = \"blueBar\";\r\n                if (max === h2) cls = \"yellowBar\";\r\n                else if (max === h3) cls = \"purpleBar\";\r\n                else if (max === h4) cls = \"redBar\";\r\n                return (\r\n                  <div className=\"aCol\" key={idx} title={`bucket ${idx + 1}`}>\r\n                    <div className={`aBar ${cls}`} style={{ height: `${max}%` }} />\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n            <div className=\"aChartAxis\">\r\n              <span>14:45</span>\r\n              <span>14:50</span>\r\n              <span>14:55</span>\r\n              <span>15:00 (NOW)</span>\r\n            </div>\r\n          </section>\r\n\r\n          <section className=\"aCard\">\r\n            <div className=\"aFeedTop\">\r\n              <div>\r\n                <div className=\"aCardTitle\">Live Feed</div>\r\n                <div className=\"mutedSmall\">Latest reactions</div>\r\n              </div>\r\n              <span className=\"aGreenDot\" />\r\n            </div>\r\n            <div className=\"aFeedList\">\r\n              {feed.map((f, i) => {\r\n                const emo = (f.Emotion || f.emotion || \"happy\").toLowerCase();\r\n                const ts = f.Timestamp || f.timestamp || f.createdAt;\r\n                return (\r\n                  <div className=\"aFeedRow\" key={getKey(f) ?? i}>\r\n                    <div className=\"aFeedEmoji\">{EMOJI[emo] || \"ðŸ™‚\"}</div>\r\n                    <div className=\"aFeedText\">\r\n                      <div className=\"aFeedTitle\">Anonymous Student</div>\r\n                      <div className=\"aFeedSub\">Reacted <b>\"{emo}\"</b></div>\r\n                    </div>\r\n                    <div className=\"aFeedTime\">{timeAgo(ts)}</div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </section>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}